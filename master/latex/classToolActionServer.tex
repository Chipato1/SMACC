\hypertarget{classToolActionServer}{}\section{Tool\+Action\+Server Class Reference}
\label{classToolActionServer}\index{Tool\+Action\+Server@{Tool\+Action\+Server}}


Collaboration diagram for Tool\+Action\+Server\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classToolActionServer_a780b72c834c95d45941ff6374c03c1c6}{Tool\+Action\+Server} ()
\item 
void \hyperlink{classToolActionServer_afe566312095ca250bc32f98a11774f2b}{publish\+Feedback} ()
\item 
void \hyperlink{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb}{execute} (const smacc\+\_\+action\+\_\+client\+\_\+generic\+::\+Tool\+Control\+Goal\+Const\+Ptr \&goal)
\item 
void \hyperlink{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469}{run} ()
\item 
void \hyperlink{classToolActionServer_aef01c70e358c933855db3a37b46a3740}{publish\+State\+Marker} ()
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::shared\+\_\+ptr$<$ \hyperlink{odom__tracker__node_8cpp_a9884574d0480319430f628f79afc0500}{Server} $>$ \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\+\_\+}
\item 
ros\+::\+Publisher \hyperlink{classToolActionServer_a1b3cb5d19e61b0207ef3f8fd99fc196d}{state\+Marker\+Publisher\+\_\+}
\item 
smacc\+\_\+action\+\_\+client\+\_\+generic\+::\+Tool\+Control\+Goal \hyperlink{classToolActionServer_ad2320c18b9cf85de44f77e9815368902}{cmd}
\item 
uint8\+\_\+t \hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{current\+State\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 22 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\index{Tool\+Action\+Server@{Tool\+Action\+Server}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\index{Tool\+Action\+Server@{Tool\+Action\+Server}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{Tool\+Action\+Server()}{ToolActionServer()}}]{\setlength{\rightskip}{0pt plus 5cm}Tool\+Action\+Server\+::\+Tool\+Action\+Server (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classToolActionServer_a780b72c834c95d45941ff6374c03c1c6}{}\label{classToolActionServer_a780b72c834c95d45941ff6374c03c1c6}
constructor() 

Definition at line 38 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.


\begin{DoxyCode}
39   \{
40     \hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{currentState\_} =  smacc\_action\_client\_generic::ToolControlResult::STATE\_UNKNOWN;
41   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Tool\+Action\+Server@{Tool\+Action\+Server}!execute@{execute}}
\index{execute@{execute}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{execute(const smacc\+\_\+action\+\_\+client\+\_\+generic\+::\+Tool\+Control\+Goal\+Const\+Ptr \&goal)}{execute(const smacc_action_client_generic::ToolControlGoalConstPtr &goal)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tool\+Action\+Server\+::execute (
\begin{DoxyParamCaption}
\item[{const smacc\+\_\+action\+\_\+client\+\_\+generic\+::\+Tool\+Control\+Goal\+Const\+Ptr \&}]{goal}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb}{}\label{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb}
\hyperlink{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb}{execute()} 

Definition at line 60 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



References publish\+Feedback(), and publish\+State\+Marker().



Referenced by run().


\begin{DoxyCode}
61 \{
62   ROS\_INFO\_STREAM(\textcolor{stringliteral}{"Tool action server request: "}<< *goal);
63   \hyperlink{classToolActionServer_ad2320c18b9cf85de44f77e9815368902}{cmd} = *goal;
64 
65   \textcolor{keywordflow}{if}(goal->command == smacc\_action\_client\_generic::ToolControlGoal::CMD\_START)
66   \{
67     \hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{currentState\_} =  smacc\_action\_client\_generic::ToolControlResult::STATE\_RUNNING;
68   \}
69   \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (goal->command == smacc\_action\_client\_generic::ToolControlGoal::CMD\_STOP)
70   \{
71     \hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{currentState\_} =  smacc\_action\_client\_generic::ToolControlResult::STATE\_IDLE;
72   \}
73 
74   \textcolor{comment}{// 10Hz internal loop}
75   ros::Rate rate(20);
76 
77   \textcolor{keywordflow}{while}(ros::ok())
78   \{
79     \textcolor{keywordflow}{if}(\hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_}->isPreemptRequested())
80     \{
81        \textcolor{comment}{// a new request is being executed, we will stop this one}
82        ROS\_WARN(\textcolor{stringliteral}{"ToolActionServer request preempted. Forgetting older request."});
83        \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_}->setPreempted(); 
84        \textcolor{keywordflow}{return};
85     \}
86     
87     \hyperlink{classToolActionServer_afe566312095ca250bc32f98a11774f2b}{publishFeedback}();
88     \hyperlink{classToolActionServer_aef01c70e358c933855db3a37b46a3740}{publishStateMarker}();
89     rate.sleep();
90   \}
91 
92    \textcolor{comment}{// never reach succeded because were are interested in keeping the feedback alive}
93    \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_}->setSucceeded();
94 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb_icgraph}
\end{center}
\end{figure}


\index{Tool\+Action\+Server@{Tool\+Action\+Server}!publish\+Feedback@{publish\+Feedback}}
\index{publish\+Feedback@{publish\+Feedback}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{publish\+Feedback()}{publishFeedback()}}]{\setlength{\rightskip}{0pt plus 5cm}void Tool\+Action\+Server\+::publish\+Feedback (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classToolActionServer_afe566312095ca250bc32f98a11774f2b}{}\label{classToolActionServer_afe566312095ca250bc32f98a11774f2b}
\hyperlink{classToolActionServer_afe566312095ca250bc32f98a11774f2b}{publish\+Feedback()} 

Definition at line 48 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



Referenced by execute().


\begin{DoxyCode}
49 \{
50     smacc\_action\_client\_generic::ToolControlFeedback feedback\_msg;
51     
52     \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_}->publishFeedback(feedback\_msg);
53 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer_afe566312095ca250bc32f98a11774f2b_icgraph}
\end{center}
\end{figure}


\index{Tool\+Action\+Server@{Tool\+Action\+Server}!publish\+State\+Marker@{publish\+State\+Marker}}
\index{publish\+State\+Marker@{publish\+State\+Marker}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{publish\+State\+Marker()}{publishStateMarker()}}]{\setlength{\rightskip}{0pt plus 5cm}void Tool\+Action\+Server\+::publish\+State\+Marker (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classToolActionServer_aef01c70e358c933855db3a37b46a3740}{}\label{classToolActionServer_aef01c70e358c933855db3a37b46a3740}
\hyperlink{classToolActionServer_aef01c70e358c933855db3a37b46a3740}{publish\+State\+Marker()} 

Definition at line 121 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



Referenced by execute().


\begin{DoxyCode}
122 \{
123     visualization\_msgs::Marker marker;
124     marker.header.frame\_id = \textcolor{stringliteral}{"base\_link"};
125     marker.header.stamp = ros::Time::now ();
126 
127     marker.ns = \textcolor{stringliteral}{"tool\_namespace"};
128     marker.id = 0;
129     marker.type = visualization\_msgs::Marker::SPHERE;
130     marker.action = visualization\_msgs::Marker::ADD;
131     
132     marker.scale.x = 0.2;
133     marker.scale.y = 0.2;
134     marker.scale.z = 0.2;
135 
136     marker.color.a = 1;
137 
138     \textcolor{keywordflow}{if}(\hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{currentState\_} == smacc\_action\_client\_generic::ToolControlResult::STATE\_RUNNING)
139     \{
140       \textcolor{comment}{// show green ball}
141       marker.color.r = 0;
142       marker.color.g = 1;
143       marker.color.b = 0;
144     \}
145     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{currentState\_} == smacc\_action\_client\_generic::ToolControlResult::STATE\_IDLE)
146     \{
147       \textcolor{comment}{// show gray ball}
148       marker.color.r = 0.7;
149       marker.color.g = 0.7;
150       marker.color.b = 0.7;
151     \}
152     \textcolor{keywordflow}{else}
153     \{
154       \textcolor{comment}{// show black ball}
155       marker.color.r = 0;
156       marker.color.g = 0;
157       marker.color.b = 0;
158     \}
159 
160     marker.pose.orientation.w=1;
161     marker.pose.position.x=0;
162     marker.pose.position.y=0;
163     marker.pose.position.z=1;
164 
165     visualization\_msgs::MarkerArray ma;
166     ma.markers.push\_back(marker);
167 
168     \hyperlink{classToolActionServer_a1b3cb5d19e61b0207ef3f8fd99fc196d}{stateMarkerPublisher\_}.publish(ma);
169 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer_aef01c70e358c933855db3a37b46a3740_icgraph}
\end{center}
\end{figure}


\index{Tool\+Action\+Server@{Tool\+Action\+Server}!run@{run}}
\index{run@{run}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{run()}{run()}}]{\setlength{\rightskip}{0pt plus 5cm}void Tool\+Action\+Server\+::run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469}{}\label{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469}
\hyperlink{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469}{run()} 

Definition at line 101 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



References execute().



Referenced by main().


\begin{DoxyCode}
102 \{
103   ros::NodeHandle n;
104   ROS\_INFO(\textcolor{stringliteral}{"Creating tool action server"});
105 
106   \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_} = std::make\_shared<Server>(n, \textcolor{stringliteral}{"tool\_action\_server"}, boost::bind(&
      \hyperlink{classToolActionServer_a34bd6fce77510778d5a51385afeb36bb}{ToolActionServer::execute}, \textcolor{keyword}{this},  \_1), \textcolor{keyword}{false});
107   ROS\_INFO(\textcolor{stringliteral}{"Starting Tool Action Server"});
108 
109   \hyperlink{classToolActionServer_a1b3cb5d19e61b0207ef3f8fd99fc196d}{stateMarkerPublisher\_} = n.advertise<visualization\_msgs::MarkerArray>(\textcolor{stringliteral}{"tool\_markers"},
       1); 
110 
111   \hyperlink{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{as\_}->start();
112 
113   ros::spin();
114 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{classToolActionServer_adbf39061e0f8c74352cbdc695d7d8469_icgraph}
\end{center}
\end{figure}




\subsection{Member Data Documentation}
\index{Tool\+Action\+Server@{Tool\+Action\+Server}!as\+\_\+@{as\+\_\+}}
\index{as\+\_\+@{as\+\_\+}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{as\+\_\+}{as_}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::shared\+\_\+ptr$<${\bf Server}$>$ Tool\+Action\+Server\+::as\+\_\+}\hypertarget{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}{}\label{classToolActionServer_a2b90828292eb25a69449de1e67a173d6}


Definition at line 25 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.

\index{Tool\+Action\+Server@{Tool\+Action\+Server}!cmd@{cmd}}
\index{cmd@{cmd}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{cmd}{cmd}}]{\setlength{\rightskip}{0pt plus 5cm}smacc\+\_\+action\+\_\+client\+\_\+generic\+::\+Tool\+Control\+Goal Tool\+Action\+Server\+::cmd}\hypertarget{classToolActionServer_ad2320c18b9cf85de44f77e9815368902}{}\label{classToolActionServer_ad2320c18b9cf85de44f77e9815368902}


Definition at line 29 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.

\index{Tool\+Action\+Server@{Tool\+Action\+Server}!current\+State\+\_\+@{current\+State\+\_\+}}
\index{current\+State\+\_\+@{current\+State\+\_\+}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{current\+State\+\_\+}{currentState_}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t Tool\+Action\+Server\+::current\+State\+\_\+}\hypertarget{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}{}\label{classToolActionServer_aac4862d8c313b07e8506eb0c74507fb1}


Definition at line 31 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.

\index{Tool\+Action\+Server@{Tool\+Action\+Server}!state\+Marker\+Publisher\+\_\+@{state\+Marker\+Publisher\+\_\+}}
\index{state\+Marker\+Publisher\+\_\+@{state\+Marker\+Publisher\+\_\+}!Tool\+Action\+Server@{Tool\+Action\+Server}}
\subsubsection[{\texorpdfstring{state\+Marker\+Publisher\+\_\+}{stateMarkerPublisher_}}]{\setlength{\rightskip}{0pt plus 5cm}ros\+::\+Publisher Tool\+Action\+Server\+::state\+Marker\+Publisher\+\_\+}\hypertarget{classToolActionServer_a1b3cb5d19e61b0207ef3f8fd99fc196d}{}\label{classToolActionServer_a1b3cb5d19e61b0207ef3f8fd99fc196d}


Definition at line 27 of file tool\+\_\+action\+\_\+server\+\_\+node.\+cpp.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
smacc\+\_\+sm\+\_\+reference\+\_\+library/sm\+\_\+dance\+\_\+bot/test/tool\+\_\+action\+\_\+server/src/\hyperlink{tool__action__server__node_8cpp}{tool\+\_\+action\+\_\+server\+\_\+node.\+cpp}\end{DoxyCompactItemize}
